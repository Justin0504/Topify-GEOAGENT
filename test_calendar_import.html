<!DOCTYPE html>
<html>
<head>
    <title>Calendar Import Test</title>
</head>
<body>
    <h1>Calendar Import Test</h1>
    <div id="result"></div>
    <script>
        // Test regex
        const testContent = `ğŸ“Š **Pillar-Based å†…å®¹è§„åˆ’å®Œæˆ**
        
è·¯å¾„: /Users/justin/Downloads/open-webui-main/output/content_plan_topify_ai_20251231_155726.xlsx

<!-- CALENDAR_IMPORT_DATA:eyJzb3VyY2UiOiJjb250ZW50X3BsYW4iLCJhcnRpY2xlcyI6W3siaWQiOiJQMDEiLCJ0aXRsZSI6IlRlc3QgQXJ0aWNsZSIsInB1Ymxpc2hfZGF0ZSI6IjIwMjUtMDEtMDEiLCJjb21wbGV0ZWQiOmZhbHNlfV19 -->`;

        const regex = /<!--\s*CALENDAR_IMPORT_DATA:([A-Za-z0-9+/=]+)\s*-->/;
        const match = testContent.match(regex);
        
        const resultDiv = document.getElementById('result');
        if (match && match[1]) {
            try {
                const jsonStr = atob(match[1]);
                const data = JSON.parse(jsonStr);
                resultDiv.innerHTML = '<p style="color: green;">âœ… æ ‡è®°æ£€æµ‹æˆåŠŸï¼</p>' +
                    '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            } catch (e) {
                resultDiv.innerHTML = '<p style="color: red;">âŒ Base64 è§£ç å¤±è´¥: ' + e.message + '</p>';
            }
        } else {
            resultDiv.innerHTML = '<p style="color: red;">âŒ æœªæ‰¾åˆ°æ ‡è®°</p><pre>' + testContent + '</pre>';
        }
    </script>
</body>
</html>
